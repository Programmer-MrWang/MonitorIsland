<ci:ComponentBase
    x:Class="MonitorIsland.Controls.Components.MonitorComponentSettingsControl"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ci="http://classisland.tech/schemas/xaml/core"
    xmlns:controls="clr-namespace:FluentAvalonia.UI.Controls;assembly=FluentAvalonia"
    xmlns:converters="clr-namespace:MonitorIsland.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:MonitorIsland.Controls.Components"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="clr-namespace:MonitorIsland.Models"
    xmlns:attributes="clr-namespace:MonitorIsland.Attributes"
    xmlns:settings="clr-namespace:MonitorIsland.Models.ComponentSettings"
    d:DesignHeight="450"
    d:DesignWidth="800"
    x:TypeArguments="settings:MonitorComponentSettings"
    Loaded="MonitorComponentSettingsControl_OnLoaded"
    mc:Ignorable="d">
    <ci:ComponentBase.Resources>
        <converters:EnumDescriptionConverter x:Key="EnumDescriptionConverter" />
    </ci:ComponentBase.Resources>
    <Grid DataContext="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=local:MonitorComponentSettingsControl}}">
        <ScrollViewer>
            <StackPanel>
                <controls:SettingsExpander
                    Header="监控项目"
                    Description="选择要监控的东西"
                    Margin="0,0,0,6"
                    IconSource="{ci:FluentIconSource &#xEE21;}">
                    <controls:SettingsExpander.Footer>
                        <ComboBox
                            MinWidth="150"
                            ItemsSource="{Binding MonitorProviders}"
							SelectedValueBinding="{Binding Id}"
                            SelectedValue="{Binding Settings.SelectedProviderId, Mode=TwoWay}">
                            <ComboBox.ItemTemplate>
                                <DataTemplate DataType="{x:Type models:MonitorProvider}">
                                    <TextBlock Text="{Binding Name}" />
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </controls:SettingsExpander.Footer>
                </controls:SettingsExpander>

                <controls:SettingsExpander
                    Header="显示设置"
                    Description="更改前缀和单位等设置"
                    Margin="0,0,0,6"
                    IconSource="{ci:FluentIconSource &#xF17E;}"
                    IsExpanded="True">

                    <controls:SettingsExpanderItem
                        Content="前缀"
                        Description="显示在数据前面的提示文字"
                        IconSource="{ci:FluentIconSource &#xF171;}">
                        <controls:SettingsExpanderItem.Footer>
                            <TextBox MinWidth="150" Text="{Binding Settings.DisplayPrefix, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" />
                        </controls:SettingsExpanderItem.Footer>
                    </controls:SettingsExpanderItem>

                    <controls:SettingsExpanderItem
                        Content="单位"
                        Description="选择单位"
                        IconSource="{ci:FluentIconSource &#xEEAF;}">
                        <controls:SettingsExpanderItem.Footer>
                            <ComboBox
                                MinWidth="80"
                                ItemsSource="{Binding Settings.AvailableUnits}"
                                SelectedItem="{Binding Settings.SelectedUnit, Mode=TwoWay}">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate DataType="{x:Type models:DisplayUnit}">
                                        <TextBlock Text="{Binding Converter={StaticResource EnumDescriptionConverter}}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </controls:SettingsExpanderItem.Footer>
                    </controls:SettingsExpanderItem>
                </controls:SettingsExpander>

                <controls:SettingsExpander
                    Header="刷新间隔（ms）"
                    Description="设置更新数值的频率（最低 250ms 刷新一次，默认 1000ms）"
                    Margin="0,0,0,6"
                    IconSource="{ci:FluentIconSource &#xF361;}">
                    <controls:SettingsExpander.Footer>
                        <StackPanel Orientation="Horizontal">
                            <NumericUpDown
                                Increment="50"
                                Minimum="250"
                                Value="{Binding Settings.RefreshInterval, Mode=TwoWay}" />
                            <Label>ms</Label>
                        </StackPanel>
                    </controls:SettingsExpander.Footer>
                </controls:SettingsExpander>

                <controls:SettingsExpander 
                Header="监控项特殊设置"
                Margin="0,0,0,6"
                    IconSource="{ci:FluentIconSource &#xEE21;}"
                    IsVisible="{Binding Settings.ShowProviderSettingsControl}">
					<controls:SettingsExpanderItem>
						<ContentPresenter Name="ProviderSettingsControl" />
                    </controls:SettingsExpanderItem>
                </controls:SettingsExpander>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</ci:ComponentBase>